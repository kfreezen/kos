#include <dma.h>

#include <KOSTypes.h>

void DMA_Init() {
	outb(0x0a, 0x06);
	outb(0xd8, 0xff);
	outb(0x04, 0);	// address=0x1000: look at this command and the one below.
	outb(0x04, 0x10);
	outb(0x81, 0); // Set the top 8 bits of the address to 0x00.
	outb(0xd8, 0xff);
	outb(0x05, 0xff); // count to number of bytes in fdd track.
	outb(0x05, 0x23);
	outb(0x80, 0);
	outb(0x0a, 0x02);
	
}

void DMA_PrepareRead() {
	outb(0x0a, 0x06);
	outb(0x0b, 0x56);
	outb(0x0a, 0x02);
}

void DMA_PrepareWrite() {
	outb(0x0a, 0x06);
	outb(0x0b, 0x5a);
	outb(0x0a, 0x02);
}
