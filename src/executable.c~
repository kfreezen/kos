#include <executable.h>
#include <kheap.h>

ProcessInfo* setupExecutable(ExeHeader* eh) {
	ProcessInfo* ret = kmalloc(sizeof(ProcessInfo));
	if(eh->magic!=EXE_MAGIC) {
		return NULL;
	}
	
	// If text_mem or data_mem is in the first 32 MB of memory...
	if(eh->text_mem < (32*1024*1024) || eh->data_mem < (32*1024*1024)) {
		return NULL;
	}
	
	PageDirectory* pd = kmalloc_a(sizeof(PageDirectory), true);
	pd->d[1023] = (PageDirectoryEntry) pd->d;
	
	// Right now don't worry about malloc calls
	
}
